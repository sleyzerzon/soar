# these elaboration rules fire in the top-state, but I'm putting them here because they are used by this code
sp {simple-robot*elaborate*move-to-cutoff-time
   (state <s> ^move-to <mt>
              ^replan-time <rpt>)
   (<mt> ^time <t>)
-->
   (<mt> ^cutoff (+ <t> <rpt>))
}

sp {simple-robot*elaborate*move-to-give-up
   (state <s> ^move-to <mt>
              ^io.input-link.time.seconds > <ct>)
   (<mt> ^cutoff <ct>)
-->
   (<mt> ^give-up true)
}

sp {go-to-location*propose*give-up-on-move-to
   (state <s> ^name go-to-location
              ^top-state.move-to <mt>)
   (<mt> ^give-up true)
-->
   (<s> ^operator <op> +)
   (<op> ^name give-up-on-move-to
         ^move-to <mt>)
}

sp {apply*give-up-on-move-to
   (state <s> ^operator <op>
              ^waypoints.at <w>
              ^top-state <ts>)
   (<op> ^name give-up-on-move-to
         ^map-updated true
         ^move-to <mt>)
   (<ts> ^move-to <mt>)
   (<mt> ^source <w>)
-->
   (<ts> ^move-to <mt> -)
}
