% ----------------------------------------------------------------------------
\typeout{--------------- The Soar User INTERFACE -----------------------------}
\chapter{The Soar User Interface}
\label{INTERFACE}
\index{interface}
%\index{user interface}
%\index{function definitions}

\nocomment{for each command, use the 'funsum' command with a brief
	description. This writes to the manual.glo file which can be edited
	into the funtion summary and index (see that file for more
	instructions). This is a bit tedious, but the reason I've set it up
	this way is that the command set is in flux right now -- this lessens
	the chance that a command will be inadvertently omitted from the
	function summary (or that a defunct command will be inadvertently
	included). 
	}

\nocomment{\begin{figure}[h]
\psfig{figure=dilbert-living.ps,height=2.2in} \vspace{12pt}
\end{figure}
}
% ----------------------------------------------------------------------------


This chapter describes the set of user interface commands for Soar. All commands and examples are presented as 
if they are being entered at the Soar command prompt.

This chapter is organized into 7 sections:
\begin{enumerate}
\item Basic Commands for Running Soar
\item Examining Memory
\item Configuring Trace Information and Debugging
\item Configuring Soar's Run-Time Parameters
\item File System I/O Commands
\item Soar I/O commands
\item Miscellaneous Commands
\end{enumerate}

Each section begins with a summary description of the commands covered
in that section, including the role of the command and its importance
to the user.  Commands are then described fully, in alphabetical order.
The most accurate and up-to-date information on the syntax of the Soar 
User Interface is found online, on the Soar Wiki, at

\begin{verbatim}
   http://winter.eecs.umich.edu/soarwiki/Soar_Command_Line_Interface}.
\end{verbatim}

Throughout this chapter, each function description includes a specification of
its syntax and an example of its use. 

For a concise overview of the Soar interface functions, see the Function
Summary and Index on page \pageref{func-sum}. This index is intended to be a
quick reference into the commands described in this chapter.

\subsubsection*{Notation}

\nocomment{check for all commands that I've got the notation current}

The notation used to denote the syntax for each user-interface command follows
some general conventions:\vspace{-12pt}
\begin{itemize}
\item The command name itself is given in a \soarb{bold} font.\vspace{-8pt}
\item Optional command arguments are enclosed within square brackets,
	\soar{[} and \soar{]}.\vspace{-8pt}
\item A vertical bar, \soar{|}, separates alternatives.\vspace{-8pt}
\item Curly braces, \soar{\{\}}, are used to group arguments when at least
one argument from the set is required.
\item The commandline prompt that is printed by Soar, is normally
the agent name, followed by '\soar{>}'.  In the examples in this manual, 
we use ``\soar{soar>}''.
\item Comments in the examples are preceded by
a '\soar{\#}', and in-line comments are preceded by '\soar{;\#}'.
\end{itemize}

For many commands, there is some flexibility in the order in which the
arguments may be given. (See the online help for each command for more
information.)  We have not incorporated this flexible ordering into the syntax
specified for each command because doing so complicates the specification of
the command.  When the order of arguments will affect the output
produced by a command, the reader will be alerted.

% ----------------------------------------------------------------------------
\section{Basic Commands for Running Soar}
\label{BASIC}

This section describes the commands used to start, run and stop a Soar 
program; to invoke on-line help information; and to create and 
delete Soar productions.  The specific commands described in this
section are:

\paragraph{Summary}
\begin{quote}
\begin{description}
%\item[d] - Run the Soar program for one decision cycle.
%\item[e] - Run the Soar program for one elaboration cycle.
\item[excise] - Delete Soar productions from production memory.
%\item[exit] - Terminate Soar and return to the operating system.
\item[gp] - Define a pattern used to generate and source a set of Soar productions.
\item[help] - Provide formatted, on-line information about Soar commands.
\item[init-soar] - Reinitialize Soar so a program can be rerun from scratch.
\item[quit] - Close log file, terminate Soar, and return user to the operating system.
\item[run] - Begin Soar's execution cycle.
\item[sp] - Create a production and add it to production memory.
\item[stop-soar] - Interrupt a running Soar program.
\end{description}
\end{quote}
These commands are all frequently used anytime Soar is run.

\input{commands/excise}
\input{commands/gp}
\input{commands/help}
\input{commands/init-soar}
\input{commands/quit}
\input{commands/run}
\input{commands/sp}
\input{commands/stop-soar}

\section{Examining Memory}
\label{MEMORY}

This section describes the commands used to inspect production memory,
working memory, and preference memory; to see what productions will 
match and fire in the next Propose or Apply phase;  and to examine the 
goal dependency set.  These commands are particularly useful when
running or debugging Soar, as they let users see what Soar is ``thinking.''
The specific commands described in this section are:

\paragraph{Summary}
\begin{quote}
\begin{description}
\item[default-wme-depth] - Set the level of detail used to print WMEs.
\item[gds-print] - Print the WMEs in the goal dependency set for each goal.
\item[internal-symbols] - Print information about the Soar symbol table.
\item[matches] - Print information about the match set and partial matches.
\item[memories] - Print memory usage for production matches.
\item[preferences] - Examine items in preference memory.
\item[print] - Print items in working memory or production memory.
\item[production-find] - Find productions that contain a given pattern.
%\item[wmes] - An alias for the print command; prints items in working memory.
\end{description}
\end{quote}

Of these commands, \textbf{print} is the most often used (and the most
complex) followed by \textbf{matches} and \textbf{memories}.  \textbf{preferences}
is used to examine which candidate operators have been proposed.
\textbf{production-find} is especially useful when the number of
productions loaded is high.  \textbf{gds-print}
is useful for examining the goal dependecy set when subgoals seem to
be disappearing unexpectedly.  \textbf{default-wme-depth} is related to the \textbf{print} command.
\textbf{internal-symbols} is not often used but is helpful when debugging Soar extensions or
trying to locate memory leaks.

\input{commands/default-wme-depth}
\input{commands/gds-print}
\input{commands/internal-symbols}
\input{commands/matches}
\input{commands/memories}
\input{commands/preferences}
\input{commands/print}
\input{commands/production-find}

% ****************************************************************************
% ----------------------------------------------------------------------------
\section{Configuring Trace Information and Debugging}
\label{DEBUG}

This section describes the commands used primarily for debugging or
to configure the trace output printed by Soar as it runs.  Users may:
specify the content of the runtime trace output; ask that
they be alerted when specific productions fire and retract; 
or request details on Soar's performance.

The specific commands described in this section are:


\paragraph{Summary}
\begin{quote}
\begin{description}
\item[chunk-name-format] - Specify format of the name to use for new chunks.
\item[firing-counts] - Print the number of times productions have fired.
%\item[format-watch] - Change the trace output that's printed as Soar runs.
%\item[interrupt] - Add \& remove pre-firing interrupts on specific productions.
%\item[monitor] - Manage attachment of Tcl scripts to Soar events.
\item[pwatch] - Trace firings and retractions of specific productions.
\item[stats] - Print information on Soar's runtime statistics.
\item[verbose] -  Control detailed information printed as Soar runs.
\item[warnings] - Toggle whether or not warnings are printed.
\item[watch] - Control the information printed as Soar runs.
\item[watch-wmes] -  Print information about wmes that match a certain pattern as they are added and removed
\end{description}
\end{quote}

Of these commands, \soar{watch} is the most often used (and the most 
complex). \soar{pwatch} is related to \soar{watch}, but applies only 
to specific, named productions. \soar{firing-counts} and \soar{stats} 
are useful for understanding how much work Soar is doing. \soar{chunk-name-format} is less-frequently
used, but allows for detailed control of Soar's chunk naming.

\input{commands/chunk-name-format}
\input{commands/firing-counts}
\input{commands/pwatch}
\input{commands/stats}
\input{commands/verbose}
\input{commands/warnings}
\input{commands/watch}
\input{commands/watch-wmes}

% ----------------------------------------------------------------------------
\section{Configuring Soar's Runtime Parameters}
\label{RUNTIME}

This section describes the commands that control Soar's Runtime Parameters.
Many of these commands provide options that simplify or restrict 
runtime behavior to enable easier and more localized debugging.
Others allow users to select alternative algorithms or methodologies.
Users can configure Soar's learning mechanism; examine the
backtracing information that supports chunks and justifications;
provide hints that could improve the efficiency of the Rete matcher;
limit runaway chunking and production firing;
choose an alternative algorithm for determining whether a working memory
element receives O-support;  and 
configure options for selecting between mutually indifferent operators.

The specific commands described in this section are:

\paragraph{Summary}
\begin{quote}
\begin{description}
\item[explain-backtraces] - Print information about chunk and justification backtraces.
\item[indifferent-selection] -  Controls indifferent preference arbitration.
\item[learn] - Set the parameters for chunking, Soar's learning mechanism.
\item[max-chunks] - Limit the number of chunks created during a decision cycle.
\item[max-elaborations] - Limit the maximum number of elaboration cycles in a given phase.
\item[max-memory-usage] - Set the number of bytes that when exceeded by an agent, will trigger the memory usage exceeded event. 
\item[max-nil-output-cycles] - Limit the maximum number of decision cycles executed without producing output. 
\item[multi-attributes] - Declare multi-attributes so as to increase Rete matching efficiency.
\item[numeric-indifferent-mode] - Select method for combining numeric preferences.
\item[o-support-mode] - Choose experimental variations of o-support.
\item[predict] - Predict the next selected operator 
\item[rl] - Get/Set Soar-RL parameters and statistics 
\item[save-backtraces] - Save trace information to explain chunks and justifications.
\item[select] - Force the next selected operator 
\item[set-stop-phase] -  Controls the phase where agents stop when running by decision.
\item[timers] - Toggle on or off the internal timers used to profile Soar.
\item[waitsnc] - Generate a wait state rather than a state-no-change impasse.
\end{description}
\end{quote}

% ----------------------------------------------------------------------------
\input{commands/explain-backtraces}
\input{commands/indifferent-selection}
\input{commands/learn}
\input{commands/max-chunks}
\input{commands/max-elaborations}
\input{commands/max-memory-usage}
\input{commands/max-nil-output-cycles}
\input{commands/multi-attributes}
\input{commands/numeric-indifferent-mode}
\input{commands/o-support-mode}
\input{commands/predict}
\input{commands/rl}
\input{commands/save-backtraces}
\input{commands/select}
\input{commands/set-stop-phase}
\input{commands/timers}
\input{commands/waitsnc}

% ----------------------------------------------------------------------------

\section{File System I/O Commands}
\label{FILE-IO}

This section describes commands which interact in one way or another
with operating system input and output, or file I/O.  Users can
save/retrieve information to/from files, redirect the information
printed by Soar as it runs, and save and load the binary representation
of productions.
The specific commands described in this section are:

\paragraph{Summary}
\begin{quote}
\begin{description}
%\item[command-to-file] - Evaluate a command and print its results to a file.
%\item[\emph{directory functions}] - \soar{cd, dirs, popd, pushd, pwd}
\item[cd] - Change directory.
\item[clog] - Record all user-interface input and output to a file. \emph{(was \soar{log})}
\item[command-to-file] - Dump the printed output and results of a command to a file. 
\item[dirs] - List the directory stack.
\item[echo] -  Print a string to the current output device.
\item[ls] - List the contents of the current working directory.
\item[popd] - Pop the current working directory off the stack and change to the next directory on the stack.
\item[pushd] - Push a directory onto the directory stack, changing to it.
\item[pwd] - Print the current working directory.
\item[rete-net] - Save the current Rete net, or restore a previous one.
\item[set-library-location] - Set the top level directory containing demos/help/etc.
%\item[output-strings-destination] - Redirect the Soar output stream.
\item[source] - Load and evaluate the contents of a file.
\end{description}
\end{quote}

The \textbf{source} command is used for nearly every Soar program.  The
directory functions are important to understand so that users can
navigate directories/folders to load/save the files of interest.  
Soar applications that include a graphical interface or other
simulation environment will often require the use of \textbf{echo}  .


\input{commands/cd}
\input{commands/clog}
\input{commands/command-to-file}
\input{commands/dirs}
\input{commands/echo}
\input{commands/ls}
\input{commands/popd}
\input{commands/pushd}
\input{commands/pwd}
\input{commands/rete-net}
\input{commands/set-library-location}
\input{commands/source}

% ***************************************************************************
% ----------------------------------------------------------------------------
\section{Soar I/O Commands}
\label{SOAR-IO}

This section describes the commands used to manage Soar's Input/Output
(I/O) system, which provides a mechanism for allowing Soar to interact 
with external systems, such as a computer game environment or a robot.  

Soar I/O functions make calls to \soar{add-wme} and \soar{remove-wme}
to add and remove elements to the \textbf{io} structure of Soar's working
memory. 
 
The specific commands described in this section are:

\paragraph{Summary}
\begin{quote}
\begin{description}
\item[add-wme] - Manually add an element to working memory.
\item[remove-wme] - Manually remove an element from working memory.
\end{description}
\end{quote}

These commands are used mainly  when Soar needs to interact with an
external environment.  Users might take advantage of these commands when
debugging agents, but care should be used in adding and removing wmes this
way as they do not fall under Soar's truth maintenance system.

\input{commands/add-wme}
\input{commands/remove-wme}

% ***************************************************************************
% ----------------------------------------------------------------------------
\section{Miscellaneous}
\label{MISC}


\comment{this section still needs to be rewritten...}

\nocomment{This section describes the commands used to inspect production memory,
working memory, and preference memory; to see what productions will 
match and fire in the next Propose or Apply phase;  and to examine the 
goal dependency set.  These commands are particularly useful when
running or debugging Soar, as they let users see what Soar is ``thinking.''}
The specific commands described in this section are:


\paragraph{Summary}
\begin{quote}
\begin{description}
\item[alias] - Define a new alias, or command, using existing commands and arguments. 
\item[edit-production] - Fire event to Move focus in an open editor to this production.
%\item  Default Rules
%\item  Predefined Aliases 
%\item  The soar.tcl file
\item[soarnews] - Prints information about the current release.
\item[srand] -  Seed the random number generator.
%\item  Soar Variables
\item[time] - Uses a default system clock timer to record the wall time required while executing a command.
\item[unalias] - Remove an existing alias.
\item[version] - Returns version number of Soar kernel.
\end{description}
\end{quote}

\input{commands/alias}
\input{commands/edit-production}
\input{commands/srand}
\input{commands/soarnews}
\input{commands/time}
\input{commands/unalias}
\input{commands/version}


% ****************************************************************************
% ----------------------------------------------------------------------------
% ****************************************************************************
% ****************************************************************************
% ****************************************************************************

\nocomment{

\subsection{Starting Soar}
\funsum{soar}{Starts Soar.}
\label{soar}
\index{soar}

To start Soar, you'll first have to find out where the Soar program is kept at
your site. Then \soar{cd} to the appropriate directory and type \soar{soar},
or specify the full pathname from your current directory.

\paragraph{Example}
\begin{verbatim}
unix% cd ~soar/soar-current
unix% soar
7.0.3. TCL TK

Bugs and questions should be sent to soar-bugs@cs.cmu.edu
The current bug-list may be obtained by sending mail to
soarhack@cs.cmu.edu with the Subject: line "bug list".

This software is in the public domain, and is made available AS IS.
Carnegie Mellon University, The University of Michigan, and
The University of Southern California/Information Sciences Institute
make no warranties about the software or its performance, implied
or otherwise.

Type "help" for information on various topics.
Type "quit" to exit.  Use ctrl-c to stop a Soar run.
Type "soarnews" for news.
Type "version" for complete version information.

soar> 
\end{verbatim} 

The Soar prompt (\soar{soar>}) indicates that you are running Soar and may
issue the commands documented in this chapter. 

\subsubsection*{Notes}

If you have problems starting Soar, it may be that your environment variables
are not set; see Section \ref{INTERFACE-tcl} for suggestions.

There are several optional arguments that can be given to the \soar{soar}
command, such as to start up multiple agents or to control windows. These are
considered advanced usage, and described in the \emph{Soar Advanced
Applications Manual}.

\comment{Karen: ``or set the path to look for startup files''

	K says to read help soartk -path option for better info}

% ----------------------------------------------------------------------------
\subsection{Files automatically loaded at startup}
\label{INTERFACE-files}

\comment{I have a note from Karen that 2 and 3 are switched for 7.0.3, but
  	that .soarrc will come before soar.soar for 7.1. Check}

\comment{smooth out a bit so that it's also appropriate for multiple agents} 

There are three files that may be loaded when Soar is first started up, if
they exist:\vspace{-12pt}
\begin{enumerate}
\item The \soar{\$soar\_library/soar.tcl} file, for your local Soar
	installation.\vspace{-6pt}
\item A \soar{.soarrc} file, in your home directory.\vspace{-6pt}
\item A \soar{soar.soar} file either in the current directory, or in your home
	directory. (Soar will check the current directory first, and load the
	first \soar{soar.soar} file it finds.)
\end{enumerate}

The files will be loaded in the order listed.\footnote{There are also some Tcl
and Tk files that are sourced at startup, but these are system files that
individual users cannot change.}

Note that the \soar{soar.soar} file is more generally
\soarit{name}\soar{.soar}, as described below.


\subsubsection*{The \soarb{\$soar\_library/soar.tcl} file}

The \soar{\$soar\_library/soar.tcl} file is loaded for all users at a local
site, and can be reconfigured by the local Soar administrator. This file is used
to load local aliases; it also contains the Tcl code that implements many of
the user-interface functions. It is also the appropriate place for
platform-dependent code.

Individual Soar users have no control over this file.


\subsubsection*{The \soarb{.soarrc} file}

	\betacomment{I'm not sure what \$HOME means for non-Unix users.}

Soar will check for a \soar{.soarrc} file in your home directory (as defined
in your \soar{\$HOME} variable), and load the file if it exists. This works
the same as if you had typed ``\soar{source .soarrc}'' at the prompt.

The \soarb{.soarrc} file is used to load personal aliases and Tcl code that
the user wants to use for all Soar applications. When multiple agents and
interpreters are used, they will all \soar{source} this file.

\comment{Note from K: currently loaded only once at startup. On the list to be
	fixed for 7.1

	I'm not sure what she means -- that it doesn't or didn't work for
	multiple agents in 7.0.4?}


\subsubsection*{The \soarb{soar.soar} file}

Soar will check for a \soar{soar.soar} file first in the current directory,
and then in your home directory (as defined in your \soar{\$HOME} variable),
and load the first \soar{soar.soar} file it finds. This is executed 
as if you had typed ``\soar{source soar.soar}'' at the Soar prompt.

	\comment{Once again, I'm not sure how \$HOME is resolved on non-Unix
	platforms.}

The \soar{soar.soar} file will typically contain other \soar{source} commands
(see Section \ref{source} below). For example, this file might be used to
automatically load in a set of individual alias definitions (see the
\soar{alias} command in Section \ref{alias}), to automatically load the
default rules (see Section \ref{default}), or even to automatically load in
the productions for a task.

When running multiple agents and interpreters, it is important to know that
the \soar{soar.soar} initialization file is generically
\soar{$<$agent-name$>$.soar}, which will be different for each agent. For
single-agent soar, the default agent is called \soar{soar}. The use of
multiple agents and interpreters is described in Chapter \ref{ADVANCED}, and
more thoroughly in the \textit{Soar Advanced Applications Manual}.


% ----------------------------------------------------------------------------
\subsection{Comments and Caveats about Tcl}
\label{INTERFACE-tcl}

The addition of Tcl to Soar provides additional functionality to the Soar
interface, but also imposes some restrictions on syntax. This section
describes some of the features and potential problems you may encounter.


\subsubsection*{Environment variables}

There are several environment variables that must be set in your operating
system for Soar to run. Many sites will have scripts installed so that the
Soar user need not set these variables explicitly. However, if you have
problems starting up Soar, you may wish to check these as a first course of
action. See the file \soar{SOAR\_INSTALLATION\_SETTINGS} (in the directory in
which Soar was built), which should contain a listing of the environment
variables and their correct settings.

\comment{Again, it's not clear what the equivalent is for non-Unix
	installations.} 

If you cannot locate this file, consult the person who installed Soar at your
site, or send mail to \soar{soar-bugs@cs.cmu.edu} to ask for help.

\subsubsection*{The Tcl interpreter}

All commands entered at the Soar prompt pass through the Tcl interpreter. This
has several implications for Soar users:\vspace{-12pt}
\begin{enumerate}
\item Commands entered at the Soar prompt may be Soar commands, Tcl commands,
	or operating system commands (the latter are specific to the machine
	you're running on). Soar attempts to execute a command first as a Soar
	command, second as a Tcl command, and third as an operating system
	command; in the rare case of commands that have the same name, the
	first system that can execute the command will do so.\vspace{-6pt}

\item Since Tcl is case sensitive, Soar is also case sensitive. This means, 
	for example, that ``red'', ``RED'', and ``Red'' are three different
	symbols to Soar. The one exception to case-sensitivity in Soar is
	identifiers; internally, these begin with an uppercase letter, but you
	may type identifiers with a lowercase letter also, and Soar will
	resolve the identifier correctly.\vspace{-6pt}

\item Tcl has a command-completion facility, which allows the user to type a
	partial command name in lieu of the full command name when the
	substring typed is long enough to distinguish it from other commands.

        This facility is often helpful, but may be confusing to some users: If
	the substring typed is not long enough to distinguish it from other
	commands, a listing of all the commands that may have been intended is
	printed. This listing will contain Tcl commands that may be unfamiliar
	to most Soar users.\vspace{-6pt}

\item Tcl allows variations in syntax for any command that uses
	curly braces to delimit arguments, and requires this variation for
	some specific uses. Most Soar users can proceed in ignorance of this
	variation, but it is mentioned here for completeness.

	The Soar commands affected by this variation are \soar{sp}, \soar{production-find},
	\soar{print}, \soar{wmes}, \soar{alias}, \soar{echo}, and
	\soar{command-to-file}; when these commands include Tcl variables,
	they must use double quotes as delimiters, rather than the curly
	braces.

	Using double quotes tells the Tcl interpreter to parse the string
	within the delimiters and resolve the variable reference immmediately.
	When curly braces are used, Tcl does not parse the enclosed string and
	the variable reference is not resolved; the string is passed on to the
	command for execution. Usually, the latter is not the desired
	behavior when Tcl variables are used, though in some cases, it may be
	desirable.

	The upshot of this is that in almost any command that uses curly
	braces as delimiters, double quotes may safely be substituted for the
	curly braces. However, it is not as safe to switch from double quotes
	to curly braces.
\end{enumerate}

\subsubsection*{Tcl error messages}

One unfortunate consequence of commands passing through the Tcl interpreter is
that Tcl does not print all of its error messages to the screen. In rare
instances, you'll be able to find an error message only by inspecting the Tcl
variable \soar{errorInfo}. To do this, you must use the Tcl command \soar{set}
(which both displays and sets the values of variables):

\begin{verbatim}
soar> help-me
invalid command name "help-me"
soar> set errorInfo
invalid command name "help-me"
    while executing
"help-me"
soar> 
\end{verbatim}

Should you need to check this variable, be sure to note that the letter
\soar{I} is capitalized in \soar{errorInfo}, and that it is the only
capitalized letter in the variable name. 

The \soar{errorInfo} variable saves only the most recent error message; there
is no way to recover previous error messages. Note that if you make a
typographical error when you enter ``\soar{set errorInfo}'', your new last
error will be the typo, and you won't know what the problem was. (It may make
sense to \soar{alias} ``set errorInfo'' to something easier to type
accurately.)


% ----------------------------------------------------------------------------
\subsection{Conventions for entering commands}

Input to Soar is usually typed in at the Soar prompt, e.g.:
\begin{verbatim}
soar> print s1
\end{verbatim}

Multiple commands can be given on the same line as long as they are separated
by semicolons, e.g.:

\begin{verbatim}
soar> run 3 d; print s1
\end{verbatim}

Multiple commands on the same line will be called in the order listed on the
line, with each being executed to completion before the next is executed. For
example, if one of the commands starts executing Soar productions, the
following commands will not be executed until Soar halts.


While Soar is executing productions (often called \emph{running}), it can be
interrupted by typing the break character, which is usually \soar{control-C}.
This will cause Soar to stop at the end of the current elaboration cycle and
return to a Soar prompt. (This only works while Soar is running, and not while
it's loading productions or waiting for you to type input to a RHS
\soar{accept} action or to the \soar{indifferent-selection} prompt.)

\nocomment{no textio anymore, so that last bit needs to be changed...does it
	still apply to user-select? (did it ever?) are there any other
	situations that it might apply to?}


Commands may also be placed in a file (see the \soar{source} command); if a
graphical user interface (GUI) is in use, commands may be executed via menus
or buttons. (Writing your own GUI for Soar is an advanced topic, covered in
the \emph{Soar Advanced Applications Manual}.)

Commands that refer to the attributes of WME's often use a carat symbol
(\soar{\carat}) to denote the attribute; this symbol is optional in most
commands, but is required \soar{sp}, \soar{print}, \soar{production-find}, and
the built-in alias \soar{wmes}.

	\nocomment{It seems that print/wmes is also affected, though I don't
	think it's supposed to be. And production-find.

	KJC: yes, soar does the parsing and expects ^ to identify the
	attribute, just like in sp.}

Several commands have flags that can be specified by using either numeric or
named arguments. This applies to commands in which the amount of information
printed depends on the arguments: The numeric arguments are provided for users
who prefer to think in terms of the amount of information printed, and the
named arguments are provided for users who prefer a mnemonic means of
remembering which flag to use. The commands that allow for either numeric or
named arguments are \soar{watch}, \soar{preferences}, and \soar{matches}.

% ----------------------------------------------------------------------------
\section{Beginners: Basic Commands}

The commands in this section will tell you how to load productions into Soar,
how to run a Soar program, how to quit, and how to get online help.

% ----------------------------------------------------------------------------
\section{Beginners: Additional Commands}

The commands in this section will tell you how to control the amount of output
produced during a run, how to turn learning on and off, how to define
productions, and how to control Soar's default behavior when there are
multiple objects with indifferent preferences.

% ----------------------------------------------------------------------------

% ----------------------------------------------------------------------------
\section{Beginners: Inspecting and Debugging}
\label{INTERFACE-beg-inspect}

The commands in this section will help you inspect production memory, working
memory, and preference memory to understand how Soar is working or to debug a
program that isn't working correctly.

% ----------------------------------------------------------------------------
% ----------------------------------------------------------------------------
% ----------------------------------------------------------------------------
\section{Beginners: Starting a New Task}

The commands in this section allow to you start a new task without quitting
and restarting Soar.

% ----------------------------------------------------------------------------
\section{Beginners: Interacting with the file system}

There are a number of commands available via Soar that allow to you change and
display the current directory for loading files into Soar. These are not
strictly ``Soar commands'' per se; some of them are available because Soar
will pass non-Soar commands to the operating system for execution (as
described in Section \ref{INTERFACE-tcl}).

The commands in this section are described only briefly because they are
really operating system commands. They are mentioned here primarily to let you
know that this functionality is available in Soar.

\paragraph{Notes}

These commands may not work or may work differently on non-Unix machines.

\nocomment{I'm uncertain about how any of these commands work on non-Unix
	platforms} 

% ----------------------------------------------------------------------------
\section{Beginners: Miscellaneous}

The commands in this section cover a few miscellaneous features not yet
described. 

% ----------------------------------------------------------------------------
\section{Intermediate: Running and Tracing}

The commands in this section (and following sections) are more advanced than
those previously described; not all users will need this information. Included
in this section are commands for running Soar and tracing what happens as Soar
runs; this includes more advanced descriptions of commands that have already
been presented (\soar{run}, \soar{watch}, and \soar{learn}).

% ----------------------------------------------------------------------------
\subsection{\soarb{run \soar{ [n] [unit]  }}}
\funsum{run}{More arguments for running Soar.}
\label{run2}
\index{run}


Without arguments, \soar{run} causes Soar to 

\paragraph{Examples}
\begin{verbatim}
run 5 o   --> run for 3 operator selections
run       --> run until halted by a control-C or a production action
\end{verbatim}

\paragraph{Notes}

The run command is more complex when multiple agents and interpreters are in
use. By default, the command applies to all agents and interpreters, a
\soar{-self} flag is used to denote the current agent. Non-agent interpreters
may use the \soar{d}, \soar{e}, and \soar{p} arguments, but not \soar{s} or
\soar{o}. The use of multiple agents and interpreters is documented in the
\textit{Soar Advanced Applications Manual}.

\comment{I suspect \soar{s} and \soar{o} have not been well defined yet for
	use with multiple agents and interpreters. I.e., should they run until
	the current agent reaches the next state (or operator), and keep all
	agents in step in terms of decision cycles? Or should they allow all
	agents to advance to the next state (or operator), and allow the
	decision cycle count to be different for different agents? If the
	latter, how far do non-agent interpreters get to run?

	I think the former is more likely to be in effect.
	}


% ----------------------------------------------------------------------------
\section{Intermediate: Inspecting and Debugging}

The commands in this section will help you inspect production memory, working
memory, and preference memory to understand how Soar is working or to debug a
program that isn't working correctly. The \soar{print} and \soar{matches}
commands were previously described in Section \ref{INTERFACE-beg-inspect}; in
this section, these commands are explained in more depth.

% ----------------------------------------------------------------------------
\subsection{\soarb{p}}
\funsum{p}{Alias for the print command.}
\label{p}
\index{p}

The \soar{p} alias is a shorthand for the \soar{print} command and works
exactly the same way as the \soar{print} command.

\paragraph{Example}
\begin{verbatim}
soar> p s1
(S1 ^io I1 ^ontop O3 ^ontop O2 ^ontop O1 ^operator O4 + ^operator O6
       ^operator O5 + ^operator O6 + ^operator O7 + ^operator O8 +
       ^operator O9 + ^problem-space blocks ^superstate nil ^thing T1
       ^thing B1 ^thing B3 ^thing B2 ^type state)
soar> p -stack
      : ==>S: S1 
      :    O: O6 (move-block)
\end{verbatim}

% ----------------------------------------------------------------------------
\subsection{\soarb{ps}}
\funsum{ps}{Alias for the print command; prints the current subgoal stack.}
\label{ps}
\index{ps}

The \soar{ps} alias is a shorthand for the \soar{print -stack} command. It
prints the current subgoal stack.

% ----------------------------------------------------------------------------
\subsection{\soarb{pf}}
\funsum{pf}{Alias for the production-find command; finds productions that
	match a given pattern.}
\label{pf}
\index{pf}

The \soar{pf} alias is a shorthand for the \soar{prodution-find} command. It
finds productions in production memory that match a specified pattern.

% ----------------------------------------------------------------------------

% ----------------------------------------------------------------------------
% ----------------------------------------------------------------------------
\section{Intermediate: Miscellaneous}

The commands in this section cover a few miscellaneous features not yet
described. 

% ----------------------------------------------------------------------------
\section{Advanced: Running and Tracing}

The commands in this section (and following sections) are more advanced than
those previously described; only advanced Soar users will need this
information. Included in this section are commands for explaining the
formation of specific chunks and justifications, controlling the output
from the watch command, and getting online help on Tcl commands.

% ----------------------------------------------------------------------------
\section{Advanced: Evaluating and increasing efficiency}

The commands in this section are provided to evaluate the efficiency of a Soar
program and of Soar itself and also to increase the efficiency of a Soar
program by providing more information about the program to Soar.

% ----------------------------------------------------------------------------
\section{Advanced: Debugging Soar}

% ----------------------------------------------------------------------------
\section{Advanced: Experimental variations in Soar}

There are two Soar variable that represent experimental changes to the Soar
architecture. These variables are provided so that users may try out these
proposed changes to Soar and evaluate how they help or hinder the development
of their program.

These variables are set and displayed using the Tcl \soar{set} command.

	\nocomment{note that both of these commands should be variables with
	the new scheme.

	True in 7.0.3, but not in earlier versions.}


% ----------------------------------------------------------------------------
% ----------------------------------------------------------------------------
% ----------------------------------------------------------------------------
\section{Advanced: Running Multiple Agents and Interpreters}
\label{INTERFACE-advanced-multiple}

When running Soar with multiple agents (as described in Chapter
\ref{ADVANCED}), there are some additional commands that may be used. Also, 
the full set of Soar user interface commands may be used, but care must be
taken by the user to distinguish commands that apply to the current agent as
opposed to commands that apply to all agents.

\comment{have to update all of these lists:}

The following commands are independent of agents:

\soar{help, soarnews, version, exit, quit} \vspace{12pt}


The following commands by default apply only to the currently selected agent:

\begin{verbatim}
add-wme, alias, default-wme-depth, echo, 
excise, explain, firing-counts, init-soar, learn, 
matches, max-chunks, max-elaborations, memories, monitor, ms, 
multi-attributes, o-support-mode, output-strings-destination, pf, pgs, 
preferences, print, print-alias, print-all-symbols, print-stats, pwatch, 
remove-wme, rete-net, sp, spr, stats, trace-format, unalias, user-select,
warnings, watch, wmes
\end{verbatim} \vspace{12pt}


The following commands apply by default to all agents, and their use with
multiple agents will be described in this section:

\soar{run, send, command-to-interpreters}  \vspace{12pt}

\comment{command-to-interpreters.... changed to send-to-interpreters?

	KJC: yes.}


The following commands are used only with multiple agents, and will be
described in this section:

\begin{verbatim}
create-interpreter, destroy-interpreter, eval-in-interpreters,
init-interpreter, list-interpreters, schedule-interpreter,
select-interpreter
\end{verbatim} \vspace{12pt}


Not sure what to do with these yet:

\soar{command-to-file, dirs, log, send, stop-soar, tksoar}  \vspace{12pt}


\comment{Most commands can't be issued to non-agent interpreters,
	e.g. preferences, wmes, etc., but I'm not sure what happens if you
	try

	KJC: tcl error: command not found (or something like that)} 


% ----------------------------------------------------------------------------
\subsection{\soarb{run} \soar{[-self]}}
\funsum{run}{Another run.}
\label{run3}
\index{run}

\comment{have to fix other descriptions of run, plus function summary, to
	mention this section.}

The basic \soar{run} command is described on page \pageref{run}; more advanced
usage is described on page \pageref{run2}.

When multiple agents are in use, this command works roughly the same way that
it does when a single agent is in use; the only difference is that by default
it applies to \textit{all} agents and interpreters. To run one agent or
interpreter at a time (for debugging), you may use the \soar{-self} argument,
which will restrict the \soar{run} command to apply to the current agent only.

% ----------------------------------------------------------------------------
\subsection{\soarb{send} \soar{[-self]}}
\funsum{send}{send....}
\label{send}
\index{send}

\comment{This command is still being hashed out; and I'm still not clear on
	the concept anyway.

	I think the idea is that by default, you might send a command to
	multiple agents, but that you could also specify a subset.

	KJC: see 7.0.3+ man page.

	KJC: implements the Tk 'send' command for non-tk interps --- sends
	command to one interp only.
	}

% ----------------------------------------------------------------------------
\section{Advanced: Additional Arguments When Starting Soar}
\funsum{soar}{Starts Soar.}
\label{INTERFACE-advanced-soar}
\label{soar2}
\index{soar}

When Soar is first started (e.g., by typing ``\soar{soar}'' at the Unix
prompt), there are a number of additional arguments that may be included.

These options enable the user to start Soar with a specific configuration, for
example, to have three agent interpreters and one Tk non-agent interpreter, or
to use a directory other than the current directory for scanning for startup
files for the agents.

The following options are available:

\begin{tabular}{| l | l | } \hline
argument  & effect  \\ \hline
\soar{-help}  & List the available options.\\ \hline

\soar{-agent name} & Create an agent interpreter with the specified name.\\ 
\soar{-tclsh name} & Create a non-agent Tcl interpreter with the specified name.\\ 
\soar{-wish name}  & Create a non-agent Tk intepreter with the specified name.\\ \hline

\soar{-noTk} & Turn off Tk for all interpreters specified after this argument. \\
\soar{-file filename}  & Read commands from the named file. \\ 
\soar{-path pathname}  & Scan the named path when defining intepreters. \\
\soar{-verbose} & Print detailed information about option processing. \\
\soar{-useIPC} & enable IPC for all intepreters. \\ \hline
\end{tabular} \vspace{10pt}

Arguments that apply only to wish-based (Tk) shells:

\begin{tabular}{| l | l | } \hline
argument  & effect  \\ \hline
\soar{-display displayname}  & Display all windows on the named display. \\
\soar{-sync} & Use synchronous mode for the display server. \\
\soar{-geometry geometry} & Initial geometry for window. \\ \hline
\end{tabular} \vspace{10pt}


\comment{I don't believe these are documented anywhere. Not online (more than
	something similar to the above table), and not in the advanced manual.
	}

\paragraph{Notes}

You may provide multiple names for interpreters and multiple paths to search.

You may not provide multiple file names.

Optional arguments, not predefined, are passed on to Tcl and can be used to
pass information to user-defined Tcl procedures.


	\nocomment{

		Can you source multiple files when you start up Soar? No. But
		couldn't you source a file that in turn sourced other files?

		FROM KARL: Yes, it sources the file.  No, this argument is not
		designed to initialize multiple interpreters -- that's what
		the *.soar files are for.  Following the normal Tcl usage,
		this argument is used to startup an *application* from a Tcl
		script (like the -f demos..gui.tcl does) and suppress the
		normal prompt.  This enables a GUI-controlled application to
		be started so that the command line is hidden from the user.
	}

\nocomment{Give args here for starting non-agent interpreters.

	WISH = windowing shell; tk + tcl; TCLSH = tcl shell

	arguments that apply only to wish-based shells: 
		display, geometry, sync 

	noTk is weird in that it applies to everything that follows it on the
		line, and not everything on the line. I'm also not sure why
		it's needed. The only thing I can think of is if you wanted to
		create some agents that had Tk and others that didn't (because
		we already have WISH and TCLSH to distinguish the non-agent
		interpreters that have Tk from those that don't)

	also note that optional arguments, not predefined, are passed on to
		Tcl and can be used to pass info to user-defined tcl procedures
	}

\nocomment{CLARE: I don't understand -notk option. Is this around so that some
	agents would have Tk and others wouldn't? (It would seem to apply only
	to agents, and not interpreters, since interpreters are started with
	or without Tk, depending on whether -WISH or -TCLSH is specified. But
	I want to make sure I understand.)

	KARL: This is present mainly to turn off Tk when desired (say when
	you're using Soar via a dialup line and no X).  While the argument
	processing checks to see if DISPLAY is set and a connection can be
	made, its possible that users have these vars set even when they don't
	want to use X.  This forces the matter.  Since it applies to all
	interpreters mentioned after it on the command line, it can also be
	used to turn off Tk in some of the interpreters.  -noTk applies to all
	types of interpreters, not just agent ones.  So a sequence like

	-noTk -wish foo -agent bar 

	results in a tclsh interpreter (which is a wish shell minus the Tk
	part) and an agent shell with no Tk.  This makes it easy to switch in
	and out of Tk and to test non-GUI portions of programs.  Its also
	possible that users might add other kinds of interpreters (say one
	with Tcl-DP in it) and the -noTk switch can apply to other
	interpreters as well.
	}


% ----------------------------------------------------------------------------
\section{Advanced: Tcl and Tk Functionality}
\label{INTERFACE-advanced-tcl}


% ----------------------------------------------------------------------------
\section{Advanced: Input and output concerns}
\label{INTERFACE-advanced-io}

The commands in this section describe commands that control input and output
functionality in Soar: where text is printed (from commands or the Soar trace
itself), how often input is accepted, and manually changing working memory
(bypassing the preference process). 


% ----------------------------------------------------------------------------

}
