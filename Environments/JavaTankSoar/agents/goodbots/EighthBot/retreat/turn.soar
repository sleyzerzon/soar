echo "\nLoading retreat/turn.soar"

#sp {retreat*propose*wait
#   (state <s> ^name retreat
#             -^operator.name wait)
#   -->
#   (<s> ^operator <o> + <)
#   (<o> ^name wait)}


## when in doubt, attempt to turn towards the threat direction
sp {retreat*propose*turn-towards-threat*side
   (state <s> ^name retreat
              ^status <st>)
   (<st> ^threat-direction <dir> << left right >>)
-->
   (<s> ^operator <o> + <,=)
   (<o> ^name retreat*turn-towards-threat
        ^actions <a>)
   (<a> ^rotate.direction <dir>
        ^radar.switch on)
}


## default, lowest-priority is to simply randomly turn... hope to catch enemy on radar
sp {retreat*propose*random-turn-left
   (state <s> ^name retreat)
-->
   (<s> ^operator <o> + <,=)
   (<o> ^name retreat*random-turn
        ^actions <a>)
   (<a> ^rotate.direction left
        ^radar.switch on)
}
sp {retreat*propose*random-turn-right
   (state <s> ^name retreat)
-->
   (<s> ^operator <o> + <,=)
   (<o> ^name retreat*random-turn
        ^actions <a>)
   (<a> ^rotate.direction right
        ^radar.switch on)
}


## prefer turning towards threat over random turns
sp {retreat*select*prefer-threat-over-random
  (state <s> ^operator <oA> +
              ^operator <oB> +)
   (<oA> ^name retreat*turn-towards-threat)
   (<oB> ^name retreat*random-turn)
-->
   (<s> ^operator  <oA>  >  <oB>)
}