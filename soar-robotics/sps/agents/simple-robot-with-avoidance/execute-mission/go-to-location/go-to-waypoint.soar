sp {go-to-location*propose*go-to-waypoint*destination-waypoint
   (state <s> ^name go-to-location
              ^top-state.destination-waypoint <dw>)
-->
   (<s> ^operator <op> +)
   (<op> ^name go-to-waypoint
         ^destination <dw>)
}

# 1) create waypoint structure on input-link (done by choose-waypoint)
# 2) rotate-to to the desired heading
# 3) create structures to track movement
# 4) move/rotate to the desired location (in subgoal)

sp {elaborate*operator*go-to-waypoint*waypoint
   (state <s> ^io.input-link.self.waypoints.waypoint <w>
              ^operator <o>)
   (<o> ^name go-to-waypoint
        ^destination.id <id>)
   (<w> ^id <id>)
-->
   (<o> ^waypoint <w>)
}

sp {apply*go-to-waypoint*arrived-at-destination*remove-destination-waypoint
   (state <s> ^operator <op>
              ^top-state <ts>
              ^waypoints.current-waypoint <w>)
   (<ts> ^destination-waypoint <mt>)
   (<mt> ^waypoint <w>)
   (<op> ^name go-to-waypoint
         ^destination.waypoint <w>)
-->
   (<ts> ^destination-waypoint <mt> -)
}

sp {monitor*go-to-waypoint
   (state <s> ^operator <o>)
   (<o> ^name go-to-waypoint
        ^destination.waypoint <d>)
   (<d> ^id <id> ^x <x> ^y <y>)
-->
   (write (crlf) |Going to | <id> | (| <x> |,| <y> |)|)
}
