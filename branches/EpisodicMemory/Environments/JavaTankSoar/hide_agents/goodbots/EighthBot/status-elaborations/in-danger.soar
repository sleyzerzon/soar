echo "\nLoading status-elaborations/in-danger.soar"


## tank is in danger if enemy has radar waves on him. Record direction
sp {elaborate*status*in-danger*rwaves
   (state <s> ^name tanksoar
              ^status <st>
              ^io.input-link.rwaves.<dir> yes)
-->
   (<st> ^in-danger yes)
   (<st> ^threat-direction <dir>)
}


## tank is in danger if missile(s) are incoming. Record direction
sp {elaborate*status*in-danger*incoming
   (state <s> ^name tanksoar
              ^status <st>
              ^io.input-link.incoming.<dir> yes)
-->
   (<st> ^in-danger yes)
   (<st> ^threat-direction <dir>)
}


### tank is not in danger if no missiles are incoming and no rwaves detected
#sp {elaborate*status*in-danger*no
#   (state <s> ^name tanksoar
#              ^status <st>
#              ^io.input-link <il>)
#   (<il>  -^incoming.<dir> yes
#          -^rwaves.<dir> yes)
#-->
#   (<st> ^in-danger no)
#}
#






#######################
## OLD CODE 
#######################




#sp {propose*retreat*radar
#   (state <s> ^name tanksoar
#              ^missiles-energy low
#              ^io.input-link.radar.tank)
#   -->
#   (<s> ^operator <o> + =)
#   (<o> ^name retreat)}
#
#sp {propose*retreat*incoming
#   (state <s> ^name tanksoar
#              ^missiles-energy low
#              ^io.input-link.incoming.<dir> yes)
#   -->
#   (<s> ^operator <o> + =)
#   (<o> ^name retreat)}
#
##  If the state is tanksoar and the tanks is under attack but cannot not directly sense the other tank, then 
##  propose the retreat operator.
#
#sp {propose*retreat*incoming*not-sensed
#   (state <s> ^name tanksoar
#             -^sound
#              ^io.input-link <io>)
#   (<io> ^incoming.<dir> yes
#        -^radar.tank)
#   -->
#   (<s> ^operator <o> + =)
#   (<o> ^name retreat)}
