
# DELIVERY PROBLEM SPACE

sp {robot*propose*delivery
   (state <s> ^name robot
             -^io.input-link.self.area -1
              ^current-mission <cm>)
   (<cm> ^name delivery
         ^status executing)
-->
   (<s> ^operator <op> + =)
   (<op> ^name delivery)
}

# ELABORATIONS

# tasks

sp {delivery*elaborate
   (state <s> ^name delivery
              ^top-state.parameters <params>)
-->
    (<s> ^tasks <tasks>
         ^parameters <params>)
}

# OPERATORS

# retrieve-task

sp {delivery*propose*retrieve-tasks*ecological-doors
   (state <s> ^name delivery
              ^parameters <params>
              ^top-state.current-location.type door
              ^tasks.task <task>)
   (<params> ^tasks-held-in smem
             ^method-ecological-doors yes)
  -(<task> ^object
           ^destination)
-->
   (<s> ^operator <op> + =)
   (<op> ^name retrieve-task
         ^task <task>)
}

sp {delivery*propose*retrieve-tasks*ecological-entry
   (state <s> ^name delivery
              ^parameters <params>
              ^top-state.current-location.type room
              ^tasks.task <task>)
   (<params> ^tasks-held-in smem
             ^method-ecological-entry yes)
  -(<task> ^object
           ^destination)
-->
   (<s> ^operator <op> + =)
   (<op> ^name retrieve-task
         ^task <task>)
}

sp {delivery*apply*retrieve-tasks*retrieve
   (state <s> ^name delivery
              ^operator <op>
              ^parameters.tasks-held-in smem
              ^smem.command <scmd>)
   (<op> ^name retrieve-task
         ^task <task>)
-->
   (<scmd> ^retrieve <task>)
}

# patrol

sp {delivery*propose*patrol
   "random walk fallback"
   (state <s> ^name delivery)
-->
   (<s> ^operator <op> + = <)
   (<op> ^name patrol
         ^first-area <a01>)
   (<a01> ^next <a02>
          ^id 20)
   (<a02> ^next <a03>
          ^id 25)
   (<a03> ^next <a04>
          ^id 30)
   (<a04> ^next <a05>
          ^id 35)
   (<a05> ^next <a06>
          ^id 40)
   (<a06> ^next <a07>
          ^id 0)
   (<a07> ^next <a08>
          ^id 5)
   (<a08> ^next <a09>
          ^id 10)
   (<a09> ^next nil
          ^id 15)
}
